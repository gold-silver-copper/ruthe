warning: hiding a lifetime that's elided elsewhere is confusing
   --> src/lib.rs:530:19
    |
530 |     pub fn borrow(&self) -> core::cell::Ref<Env> {
    |                   ^^^^^     ^^^^^^^^^^^^^^^^^^^^ the same lifetime is hidden here
    |                   |
    |                   the lifetime is elided here
    |
    = help: the same lifetime is referred to in inconsistent ways, making the signature confusing
    = note: `#[warn(mismatched_lifetime_syntaxes)]` on by default
help: use `'_` for type paths
    |
530 |     pub fn borrow(&self) -> core::cell::Ref<'_, Env> {
    |                                             +++

warning: hiding a lifetime that's elided elsewhere is confusing
   --> src/lib.rs:534:23
    |
534 |     pub fn borrow_mut(&self) -> core::cell::RefMut<Env> {
    |                       ^^^^^     ^^^^^^^^^^^^^^^^^^^^^^^ the same lifetime is hidden here
    |                       |
    |                       the lifetime is elided here
    |
    = help: the same lifetime is referred to in inconsistent ways, making the signature confusing
help: use `'_` for type paths
    |
534 |     pub fn borrow_mut(&self) -> core::cell::RefMut<'_, Env> {
    |                                                    +++

warning: `ruthe` (lib) generated 2 warnings (run `cargo fix --lib -p ruthe` to apply 2 suggestions)
warning: unused variable: `count4`
   --> tests/test2.rs:560:9
    |
560 |     let count4 = get_env_refcount(&env2);
    |         ^^^^^^ help: if this is intentional, prefix it with an underscore: `_count4`
    |
    = note: `#[warn(unused_variables)]` (part of `#[warn(unused)]`) on by default

warning: `ruthe` (test "test2") generated 1 warning (run `cargo fix --test "test2" -p ruthe` to apply 1 suggestion)
    Finished `release` profile [optimized] target(s) in 0.00s
     Running tests/test2.rs (target/release/deps/test2-00fda4cb0b873a75)

running 27 tests
test test_cons_cell_refcount ... ok
test test_environment_parent_chain_cleanup ... ok
test test_chain_of_environments ... FAILED
test test_empty_environment_operations ... ok
test test_lambda_environment_capture ... ok
test test_multiple_closures_same_env ... FAILED
test test_errors_dont_leak_during_evaluation ... ok
test test_nested_quote_structures ... ok
test test_deeply_nested_scopes ... FAILED
test test_partial_evaluation_errors ... ok
test test_repeated_definitions ... ok
test test_repeated_lambda_creation ... ok
test test_stress_alternating_success_and_error ... ok
test test_valref_clone_correctness ... ok
test test_valref_shared_substructure ... FAILED
test test_kitchen_sink_stress ... ok
test test_immediate_drop_stress ... ok
test test_append_large_lists ... FAILED
test test_huge_list_creation_and_destruction ... FAILED
test test_errors_in_deeply_nested_calls ... ok
test test_repeated_recursive_calls ... ok
test test_stress_many_small_operations ... ok
test test_mutual_recursion_deep ... ok
test test_repeated_large_allocations ... ok
test test_extreme_tail_recursion ... FAILED
test test_maximum_stress ... ok
test test_very_deep_tail_recursion ... ok

failures:

---- test_chain_of_environments stdout ----

thread 'test_chain_of_environments' (69143479) panicked at tests/test2.rs:191:36:
called `Result::unwrap()` on an `Err` value: ()
note: run with `RUST_BACKTRACE=1` environment variable to display a backtrace

---- test_multiple_closures_same_env stdout ----

thread 'test_multiple_closures_same_env' (69143492) panicked at tests/test2.rs:155:36:
called `Result::unwrap()` on an `Err` value: ()

---- test_deeply_nested_scopes stdout ----

thread 'test_deeply_nested_scopes' (69143481) panicked at tests/test2.rs:123:36:
called `Result::unwrap()` on an `Err` value: ()

---- test_valref_shared_substructure stdout ----

thread 'test_valref_shared_substructure' (69143503) panicked at tests/test2.rs:476:36:
called `Result::unwrap()` on an `Err` value: ()

---- test_append_large_lists stdout ----

thread 'test_append_large_lists' (69143478) panicked at tests/test2.rs:290:36:
called `Result::unwrap()` on an `Err` value: ()

---- test_huge_list_creation_and_destruction stdout ----

thread 'test_huge_list_creation_and_destruction' (69143487) panicked at tests/test2.rs:228:36:
called `Result::unwrap()` on an `Err` value: ()

---- test_extreme_tail_recursion stdout ----

thread 'test_extreme_tail_recursion' (69143486) panicked at tests/test2.rs:35:32:
called `Result::unwrap()` on an `Err` value: ()


failures:
    test_append_large_lists
    test_chain_of_environments
    test_deeply_nested_scopes
    test_extreme_tail_recursion
    test_huge_list_creation_and_destruction
    test_multiple_closures_same_env
    test_valref_shared_substructure

test result: FAILED. 20 passed; 7 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.50s

error: test failed, to rerun pass `--test test2`
warning: hiding a lifetime that's elided elsewhere is confusing
   --> src/lib.rs:530:19
    |
530 |     pub fn borrow(&self) -> core::cell::Ref<Env> {
    |                   ^^^^^     ^^^^^^^^^^^^^^^^^^^^ the same lifetime is hidden here
    |                   |
    |                   the lifetime is elided here
    |
    = help: the same lifetime is referred to in inconsistent ways, making the signature confusing
    = note: `#[warn(mismatched_lifetime_syntaxes)]` on by default
help: use `'_` for type paths
    |
530 |     pub fn borrow(&self) -> core::cell::Ref<'_, Env> {
    |                                             +++

warning: hiding a lifetime that's elided elsewhere is confusing
   --> src/lib.rs:534:23
    |
534 |     pub fn borrow_mut(&self) -> core::cell::RefMut<Env> {
    |                       ^^^^^     ^^^^^^^^^^^^^^^^^^^^^^^ the same lifetime is hidden here
    |                       |
    |                       the lifetime is elided here
    |
    = help: the same lifetime is referred to in inconsistent ways, making the signature confusing
help: use `'_` for type paths
    |
534 |     pub fn borrow_mut(&self) -> core::cell::RefMut<'_, Env> {
    |                                                    +++

warning: `ruthe` (lib) generated 2 warnings (run `cargo fix --lib -p ruthe` to apply 2 suggestions)
warning: unused variable: `count_after_define`
   --> tests/tests.rs:742:9
    |
742 |     let count_after_define = Rc::strong_count(&env.0);
    |         ^^^^^^^^^^^^^^^^^^ help: if this is intentional, prefix it with an underscore: `_count_after_define`
    |
    = note: `#[warn(unused_variables)]` (part of `#[warn(unused)]`) on by default

warning: `ruthe` (test "tests") generated 1 warning (run `cargo fix --test "tests" -p ruthe` to apply 1 suggestion)
    Finished `release` profile [optimized] target(s) in 0.00s
     Running tests/tests.rs (target/release/deps/tests-c2e09e891a675fcc)

running 74 tests
test test_addition ... ok
test test_booleans ... ok
test test_arity_mismatch ... ok
test test_append ... ok
test test_car ... ok
test test_complex_lambda_expression ... ok
test test_cons ... ok
test test_cdr ... ok
test test_cons_predicate ... ok
test test_define ... FAILED
test test_define_expression ... FAILED
test test_division ... ok
test test_empty_list ... ok
test test_division_by_zero ... ok
test test_ackermann_small ... ok
test test_environment_bindings_cleanup ... ok
test test_equality ... ok
test test_factorial ... ok
test test_greater_than ... ok
test test_factorial_larger ... ok
test test_if_nil_is_false ... ok
test test_if_false ... ok
test test_if_nested ... ok
test test_higher_order_function ... FAILED
test test_if_non_boolean_is_true ... ok
test test_fibonacci_small ... ok
test test_filter_function ... ok
test test_if_true ... ok
test test_invalid_function_call ... ok
test test_lambda_basic ... ok
test test_lambda_nested ... ok
test test_lambda_closure ... FAILED
test test_lambda_no_args ... ok
test test_length ... ok
test test_less_than ... ok
test test_list ... ok
test test_multiple_definitions ... ok
test test_multiplication ... ok
test test_map_function ... ok
test test_nested_arithmetic ... ok
test test_nested_empty_lists ... ok
test test_mutual_recursion_odd ... ok
test test_nil ... ok
test test_no_leak_with_errors ... ok
test test_nested_list_operations ... ok
test test_no_memory_leak_lambda_closure ... ok
test test_mutual_recursion ... ok
test test_no_memory_leak_multiple_evaluations ... ok
test test_numbers ... ok
test test_parse_comments ... ok
test test_parse_multiline ... ok
test test_parse_whitespace ... ok
test test_null_predicate ... ok
test test_reverse ... ok
test test_single_element_list ... ok
test test_quote ... ok
test test_self_referential_list ... ok
test test_no_memory_leak_nested_lambdas ... ok
test test_subtraction ... ok
test test_tail_recursive_factorial ... ok
test test_no_memory_leak_simple_recursion ... ok
test test_unbound_symbol ... ok
test test_fibonacci ... ok
test test_type_error_arithmetic ... ok
test test_temporary_values_cleaned_up ... FAILED
test test_valref_cleanup ... ok
test test_sum_list ... ok
test test_zero_arithmetic ... ok
test test_no_memory_leak_list_operations ... ok
test test_no_unbounded_growth ... ok
test test_countdown ... ok
test test_tail_recursive_sum ... ok
test test_ackermann ... ok
test test_countdown_large ... ok

failures:

---- test_define stdout ----

thread 'test_define' (69143582) panicked at tests/tests.rs:223:36:
called `Result::unwrap()` on an `Err` value: ()
note: run with `RUST_BACKTRACE=1` environment variable to display a backtrace

---- test_define_expression stdout ----

thread 'test_define_expression' (69143583) panicked at tests/tests.rs:243:36:
called `Result::unwrap()` on an `Err` value: ()

---- test_higher_order_function stdout ----

thread 'test_higher_order_function' (69143595) panicked at tests/tests.rs:301:36:
called `Result::unwrap()` on an `Err` value: ()

---- test_lambda_closure stdout ----

thread 'test_lambda_closure' (69143603) panicked at tests/tests.rs:275:36:
called `Result::unwrap()` on an `Err` value: ()

---- test_temporary_values_cleaned_up stdout ----

thread 'test_temporary_values_cleaned_up' (69143638) panicked at tests/tests.rs:787:36:
called `Result::unwrap()` on an `Err` value: ()


failures:
    test_define
    test_define_expression
    test_higher_order_function
    test_lambda_closure
    test_temporary_values_cleaned_up

test result: FAILED. 69 passed; 5 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.04s

error: test failed, to rerun pass `--test tests`
